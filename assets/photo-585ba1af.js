import{c as w,r as i,j as t}from"./index-b41d15ee.js";import{X as W}from"./x-783a8e78.js";const Y=w("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),he=w("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),ue=w("FlipHorizontal",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h3",key:"1i73f7"}],["path",{d:"M16 3h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-3",key:"saxlbk"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 14v2",key:"8jcxud"}],["path",{d:"M12 8v2",key:"1woqiv"}],["path",{d:"M12 2v2",key:"tus03m"}]]),pe=w("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),B=w("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),be="/yepa2k25/assets/frame1-03cf5e15.png",ge="/yepa2k25/assets/frame2-7ed83781.png",fe="/yepa2k25/assets/frame3-e7b05323.png",ve=()=>{var O,q,X,V;const U=be,G=ge,J=fe,[c,b]=i.useState({}),[o,y]=i.useState(null),[g,K]=i.useState(3),[v,N]=i.useState(!1),[z,T]=i.useState(null),[L,C]=i.useState(!1),[h,j]=i.useState(!1),[Q,Z]=i.useState("user"),n=i.useRef(null),F=i.useRef(null),H=i.useRef(null),A=i.useRef(null),E=[{id:"frame2",position:{top:"34.2%",left:"8.4%",width:"23.2%",height:"56.3%"}},{id:"frame3",position:{top:"10.4%",left:"33.3%",width:"27%",height:"81.2%"}},{id:"frame4",position:{top:"10.4%",left:"62.4%",width:"29.2%",height:"48.5%"}}],_=[{id:"frame1",position:{top:"0%",left:"0%",width:"28.1%",height:"66.3%"}},{id:"frame2",position:{top:"0%",left:"30.1%",width:"38.9%",height:"66.3%"}},{id:"frame3",position:{top:"0%",left:"72.1%",width:"28.1%",height:"66.3%"}}],ee=[{id:"frame1",position:{top:"0%",left:"0%",width:"76.3%",height:"100%"}}],P=()=>{switch(g){case 1:return U;case 2:return G;case 3:return J;default:return U}},m=(()=>{switch(g){case 1:return E;case 2:return _;case 3:return ee;default:return E}})(),$=async()=>{try{j(!1),N(!0),console.log("Requesting camera access...");const e=await navigator.mediaDevices.getUserMedia({video:{facingMode:Q},audio:!1});if(console.log("Camera access granted"),T(e),await new Promise(a=>setTimeout(a,100)),n.current){console.log("Setting video source"),n.current.srcObject=e,n.current.style.display="block",n.current.muted=!0,n.current.playsInline=!0,n.current.autoplay=!0,await new Promise(a=>{n.current&&(n.current.oncanplay=()=>{console.log("Video can play"),a(!0)},setTimeout(()=>a(!0),3e3))});try{await n.current.play(),console.log("Video is playing")}catch{console.log("Auto-play prevented, will play on user interaction")}j(!0),console.log("Camera ready")}}catch(e){console.error("Error accessing camera:",e),alert("Unable to access camera. Error: "+e),N(!1),j(!1)}},R=()=>{z&&(z.getTracks().forEach(e=>e.stop()),T(null)),n.current&&(n.current.srcObject=null),N(!1),j(!1)},te=()=>{Z(e=>e==="user"?"environment":"user"),v&&(R(),$())},ae=()=>{if(n.current&&F.current&&o){const e=n.current,a=F.current;a.width=e.videoWidth,a.height=e.videoHeight;const s=a.getContext("2d");if(s){s.save(),s.scale(-1,1),s.drawImage(e,-a.width,0,a.width,a.height),s.restore();const r=a.toDataURL("image/png");b(l=>({...l,[o]:r})),R(),y(null)}}},oe=e=>{var s;const a=(s=e.target.files)==null?void 0:s[0];if(a&&o){const r=new FileReader;r.onload=l=>{var u;const d=(u=l.target)==null?void 0:u.result;b(p=>({...p,[o]:d})),y(null)},r.readAsDataURL(a)}},se=e=>{b(a=>{const s={...a};return delete s[e],s})},re=e=>{v||y(e)},le=()=>{o?$():alert("Please select a frame first by clicking on one of the white spaces.")},ne=()=>{var e;o?(e=H.current)==null||e.click():alert("Please select a frame first by clicking on one of the white spaces.")},D=e=>{K(e),b({}),y(null)},ie=async()=>{if(A.current){C(!0);try{const e=document.createElement("canvas"),a=e.getContext("2d");if(!a)return;e.width=1293,e.height=1084;for(const r of m)if(c[r.id]){const l=new Image;l.crossOrigin="anonymous",await new Promise((ce,me)=>{l.onload=ce,l.onerror=me,l.src=c[r.id]});const d=parseFloat(r.position.left)/100*e.width,u=parseFloat(r.position.top)/100*e.height,p=parseFloat(r.position.width)/100*e.width,k=parseFloat(r.position.height)/100*e.height,I=l.width/l.height,de=p/k;let f,x,S,M;I>de?(x=k,f=x*I,S=d-(f-p)/2,M=u):(f=p,x=f/I,S=d,M=u-(x-k)/2),a.save(),a.beginPath(),a.rect(d,u,p,k),a.clip(),a.drawImage(l,S,M,f,x),a.restore()}const s=new Image;s.crossOrigin="anonymous",await new Promise((r,l)=>{s.onload=r,s.onerror=l,s.src=P()}),a.drawImage(s,0,0,e.width,e.height),e.toBlob(r=>{if(r){const l=URL.createObjectURL(r),d=document.createElement("a");d.download=`arabian-night-photobooth-${Date.now()}.png`,d.href=l,d.click(),URL.revokeObjectURL(l)}C(!1)},"image/png")}catch(e){console.error("Error downloading image:",e),alert("Failed to download image. Please try taking a screenshot instead."),C(!1)}}};return t.jsxs("div",{className:" relative min-h-screen pt-5 pb-10 w-screen overflow-hidden flex items-center justify-center p-0   bg-transparent",children:[t.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[t.jsx("div",{className:"absolute top-20 left-10 w-2 h-2 bg-yellow-200 rounded-full animate-pulse"}),t.jsx("div",{className:"absolute top-40 right-20 w-1 h-1 bg-yellow-300 rounded-full animate-pulse",style:{animationDelay:"1s"}}),t.jsx("div",{className:"absolute top-60 left-1/4 w-1.5 h-1.5 bg-yellow-100 rounded-full animate-pulse",style:{animationDelay:"2s"}}),t.jsx("div",{className:"absolute bottom-40 right-1/3 w-2 h-2 bg-yellow-200 rounded-full animate-pulse",style:{animationDelay:"0.5s"}}),t.jsx("div",{className:"absolute top-1/3 right-10 w-1 h-1 bg-yellow-300 rounded-full animate-pulse",style:{animationDelay:"1.5s"}})]}),t.jsxs("div",{className:"max-w-6xl mx-auto relative z-10",children:[t.jsx("h1",{className:"text-3xl md:text-5xl font-bold text-center mb-2 bg-gradient-to-r from-yellow-400 via-amber-300 to-yellow-500 bg-clip-text text-transparent drop-shadow-lg sm:text-lg",style:{fontFamily:"Georgia, serif"},children:"✨ Arabian Night Photobooth ✨"}),t.jsx("p",{className:"text-center text-amber-200 sm:text-sm mb-6 text-lg drop-shadow-md",children:"Choose a template, then click on a frame to add your photo"}),v&&t.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-95 z-50 flex items-center justify-center p-4",children:[t.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[t.jsx("div",{className:"absolute top-10 left-20 w-2 h-2 bg-yellow-200 rounded-full animate-pulse"}),t.jsx("div",{className:"absolute top-32 right-16 w-1 h-1 bg-yellow-300 rounded-full animate-pulse",style:{animationDelay:"1s"}}),t.jsx("div",{className:"absolute top-48 left-1/3 w-1.5 h-1.5 bg-yellow-100 rounded-full animate-pulse",style:{animationDelay:"2s"}}),t.jsx("div",{className:"absolute bottom-32 right-1/4 w-2 h-2 bg-yellow-200 rounded-full animate-pulse",style:{animationDelay:"0.5s"}}),t.jsx("div",{className:"absolute top-1/4 right-32 w-1 h-1 bg-yellow-300 rounded-full animate-pulse",style:{animationDelay:"1.5s"}}),t.jsx("div",{className:"absolute bottom-20 left-1/2 w-1.5 h-1.5 bg-yellow-100 rounded-full animate-pulse",style:{animationDelay:"0.8s"}}),t.jsx("div",{className:"absolute top-3/4 left-16 w-2 h-2 bg-yellow-200 rounded-full animate-pulse",style:{animationDelay:"2.5s"}})]}),t.jsxs("div",{className:"bg-slate-900 rounded-lg p-6 max-w-4xl w-full",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h2",{className:"text-2xl font-bold text-white",children:"Take Photo"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:te,className:"p-2 hover:bg-gray-700 rounded-full transition-colors",type:"button",title:"Switch Camera",children:t.jsx(ue,{className:"w-6 h-6 text-white"})}),t.jsx("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),R()},className:"p-2 hover:bg-gray-700 rounded-full transition-colors z-50",type:"button",children:t.jsx(W,{className:"w-6 h-6 text-white"})})]})]}),t.jsxs("div",{className:"relative w-full rounded-lg overflow-hidden bg-gray-800",style:{aspectRatio:"1293/1084"},children:[!h&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-20 bg-gray-900",children:t.jsx("div",{className:"text-white text-lg",children:"Loading camera..."})}),t.jsx("video",{ref:n,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover",style:{transform:"scaleX(-1)",display:h?"block":"none"}}),h&&t.jsx("div",{className:"absolute inset-0 pointer-events-none z-10",children:t.jsx("img",{src:P(),alt:"Frame Overlay",className:"w-full h-full object-cover"})}),h&&o&&m.find(e=>e.id===o)&&t.jsx("div",{className:"absolute border-4 border-amber-400",style:{top:((O=m.find(e=>e.id===o))==null?void 0:O.position.top)||"0",left:((q=m.find(e=>e.id===o))==null?void 0:q.position.left)||"0",width:((X=m.find(e=>e.id===o))==null?void 0:X.position.width)||"0",height:((V=m.find(e=>e.id===o))==null?void 0:V.position.height)||"0",zIndex:5,animation:"pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite"}})]}),t.jsxs("button",{onClick:ae,disabled:!h,className:"w-full mt-4 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 disabled:from-gray-600 disabled:to-gray-700 disabled:cursor-not-allowed text-white font-bold py-4 px-6 rounded-lg transition-colors flex items-center justify-center gap-2 text-lg",children:[t.jsx(Y,{className:"w-6 h-6"}),h?"Capture Photo":"Starting Camera..."]})]})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 justify-center mb-6",children:[t.jsx("button",{onClick:()=>D(1),className:`px-6 py-3 rounded-xl font-semibold transition-all backdrop-blur-md border ${g===1?"bg-gradient-to-r from-amber-500/40 to-yellow-500/40 text-white border-amber-400/70 shadow-lg shadow-amber-500/30 scale-105":"bg-gray-800/30 text-gray-300 border-gray-600/30 hover:border-amber-400/50"}`,children:"Template 1 (4 Frames)"}),t.jsx("button",{onClick:()=>D(2),className:`px-6 py-3 rounded-xl font-semibold transition-all backdrop-blur-md border ${g===2?"bg-gradient-to-r from-amber-500/40 to-yellow-500/40 text-white border-amber-400/70 shadow-lg shadow-amber-500/30 scale-105":"bg-gray-800/30 text-gray-300 border-gray-600/30 hover:border-amber-400/50"}`,children:"Template 2 (2 Frames)"}),t.jsx("button",{onClick:()=>D(3),className:`px-6 py-3 rounded-xl font-semibold transition-all backdrop-blur-md border ${g===3?"bg-gradient-to-r from-amber-500/40 to-yellow-500/40 text-white border-amber-400/70 shadow-lg shadow-amber-500/30 scale-105":"bg-gray-800/30 text-gray-300 border-gray-600/30 hover:border-amber-400/50"}`,children:"Template 3 (1 Frame)"})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 justify-center mb-6",children:[t.jsxs("button",{onClick:le,disabled:!o,className:`flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all backdrop-blur-md border ${o?"bg-gradient-to-r from-purple-500/30 to-blue-500/30 hover:from-purple-500/40 hover:to-blue-500/40 text-white border-purple-400/50 shadow-lg shadow-purple-500/20":"bg-gray-800/30 text-gray-500 cursor-not-allowed border-gray-600/30"}`,children:[t.jsx(Y,{className:"w-5 h-5"}),"Take Photo"]}),t.jsxs("button",{onClick:ne,disabled:!o,className:`flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all backdrop-blur-md border ${o?"bg-gradient-to-r from-emerald-500/30 to-teal-500/30 hover:from-emerald-500/40 hover:to-teal-500/40 text-white border-emerald-400/50 shadow-lg shadow-emerald-500/20":"bg-gray-800/30 text-gray-500 cursor-not-allowed border-gray-600/30"}`,children:[t.jsx(B,{className:"w-5 h-5"}),"Upload Photo"]}),t.jsxs("button",{onClick:ie,disabled:L,className:"flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all backdrop-blur-md bg-gradient-to-r from-amber-500/30 to-yellow-500/30 hover:from-amber-500/40 hover:to-yellow-500/40 text-white border border-amber-400/50 shadow-lg shadow-amber-500/20 disabled:opacity-50 disabled:cursor-not-allowed",children:[t.jsx(he,{className:"w-5 h-5"}),L?"Downloading...":"Download"]}),t.jsxs("button",{onClick:()=>b({}),className:"flex items-center gap-2 px-6 py-3 rounded-xl font-semibold transition-all backdrop-blur-md bg-gradient-to-r from-red-500/30 to-orange-500/30 hover:from-red-500/40 hover:to-orange-500/40 text-white border border-red-400/50 shadow-lg shadow-red-500/20",children:[t.jsx(pe,{className:"w-5 h-5"}),"Reset All"]})]}),o&&!v&&t.jsx("div",{className:"text-center mb-4 backdrop-blur-md bg-gradient-to-r from-amber-400/30 to-yellow-400/30 border border-amber-300/50 text-yellow-100 py-3 px-6 rounded-xl font-semibold shadow-lg shadow-amber-500/20",children:'✨ Frame selected! Choose "Take Photo" or "Upload Photo" ✨'}),t.jsxs("div",{ref:A,id:"photobooth-container",className:"relative w-full max-w-4xl mx-auto bg-gradient-to-br from-slate-900 to-slate-800 border border-border/20 rounded-sm   shadow-2xl shadow-[#ff950046] overflow-hidden",style:{aspectRatio:"1293/1084"},children:[m.map(e=>t.jsx("div",{className:`absolute overflow-hidden cursor-pointer transition-all duration-300 ${o===e.id?"ring-4 ring-amber-400 ring-offset-2 ring-offset-transparent":""}`,style:{top:e.position.top,left:e.position.left,width:e.position.width,height:e.position.height,zIndex:2,background:c[e.id]?"transparent":"linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(59, 130, 246, 0.1))",backdropFilter:c[e.id]?"none":"blur(10px)",border:c[e.id]?"none":"1px solid rgba(255, 255, 255, 0.18)",boxShadow:c[e.id]?"none":"0 8px 32px 0 rgba(139, 92, 246, 0.3), inset 0 2px 8px rgba(255, 255, 255, 0.15)"},onClick:()=>re(e.id),children:c[e.id]?t.jsxs(t.Fragment,{children:[t.jsx("img",{src:c[e.id],alt:`Photo in ${e.id}`,className:"w-full h-full object-cover"}),t.jsx("button",{onClick:a=>{a.stopPropagation(),se(e.id)},className:"absolute top-3 right-3 p-2.5 rounded-full transition-all backdrop-blur-md",style:{background:"linear-gradient(135deg, rgba(239, 68, 68, 0.8), rgba(220, 38, 38, 0.8))",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 4px 16px rgba(239, 68, 68, 0.4), inset 0 1px 2px rgba(255, 255, 255, 0.2)",zIndex:1},children:t.jsx(W,{className:"w-4 h-4 text-white"})})]}):t.jsx("div",{className:"w-full h-full flex items-center justify-center",children:t.jsx("div",{className:"p-8 rounded-full backdrop-blur-md transition-all hover:scale-110",style:{background:"linear-gradient(135deg, rgba(251, 191, 36, 0.2), rgba(245, 158, 11, 0.2))",border:"2px solid rgba(251, 191, 36, 0.3)",boxShadow:"0 8px 24px rgba(251, 191, 36, 0.2), inset 0 2px 8px rgba(255, 255, 255, 0.2)"},children:t.jsx(B,{className:"w-10 h-10 text-amber-300"})})})},e.id)),t.jsx("img",{src:P(),alt:"Arabian Night Frame",className:"absolute inset-0 w-full h-full object-cover pointer-events-none",style:{zIndex:10}})]}),t.jsx("input",{ref:H,type:"file",accept:"image/*",onChange:oe,className:"hidden"}),t.jsx("canvas",{ref:F,className:"hidden"})]})]})};export{ve as default};
